(this.webpackJsonpcarpooling=this.webpackJsonpcarpooling||[]).push([[0],{106:function(e,t,r){},107:function(e,t,r){},111:function(e,t,r){},112:function(e,t,r){},119:function(e,t,r){},120:function(e,t,r){},135:function(e,t,r){},138:function(e,t,r){},139:function(e,t,r){},140:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(7),c=r(85),i=(r(106),function(){return a.a.createElement("nav",{className:"Navbar",id:"Menu"},a.a.createElement("ul",null,a.a.createElement("li",null,"1"),a.a.createElement("li",null,"2"),a.a.createElement("li",null,"3"),a.a.createElement("li",null,"4")))}),l=r(27);r(107);var u=function(){var e=Object(l.f)(),t=window.location.hash;return a.a.createElement("header",{className:"Header"},a.a.createElement("div",{className:"Title"},a.a.createElement("span",null,"Carpooling")),t?a.a.createElement("button",{onClick:function(){e.goBack()}},"X"):a.a.createElement("a",{href:"#Menu"},a.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},a.a.createElement("path",{fill:"#fff",d:"M24 6h-24v-4h24v4zm0 4h-24v4h24v-4zm0 8h-24v4h24v-4z"}))),a.a.createElement(i,null))},s=(r(111),function(e){var t=e.children;return a.a.createElement("div",{className:"Layout"},a.a.createElement(u,null),a.a.createElement("main",{className:"Container"},t))}),d=r(13),f=r(14),p=r(22),m=r(167),b=r(169);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){Object(d.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O=function(e){var t=encodeURIComponent;return Object.keys(e).map((function(r){return"".concat(t(r),"=").concat(t(e[r]))})).join("&")},g=function(){var e=function(e){var t=e.baseUrl,r=e.token,n={headers:{"Content-Type":"application/json"},mode:"cors"};function a(e,r){return fetch("".concat(t).concat(e),r).then((function(e){return e.ok?e.json().catch((function(){return{}})):e.json().then((function(e){return Promise.reject(e)}))}))}return r&&(n.headers.Authorization="Bearer ".concat(r)),{del:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(e,y({method:"DELETE",body:JSON.stringify(t)},n))},get:function(e,t){var r=y({method:"GET"},n,{},t);return r.query&&(e+="?".concat(O(r.query)),delete r.query),a(e,r)},post:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(e,y({method:"POST",body:JSON.stringify(t)},n))},put:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(e,y({method:"PUT",body:JSON.stringify(t)},n))}}}({baseUrl:"https://api.carpooling.daidox.pt"});return{groups:{get:function(){return e.get("/groups")},post:function(t){return e.post("/groups",t)},by:function(t){return{get:function(){return e.get("/groups/".concat(t))},drivers:{get:function(){return e.get("/groups/".concat(t,"/drivers"))},post:function(r){return e.post("/groups/".concat(t,"/drivers"),r)}},cycles:{get:function(){return e.get("/groups/".concat(t,"/cycles"))},post:function(r){return e.post("/groups/".concat(t,"/cycles"),r)}},trips:{get:function(){return e.get("/groups/".concat(t,"/changes"))},post:function(r){return e.post("/groups/".concat(t,"/changes"),r)}}}}}}}();r(112);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var j=function(e){return e.replace(/ /g,"-").toLowerCase().trim()};var E=function(){var e=Object(n.useState)({value:"",error:!1}),t=Object(f.a)(e,2),r=t[0],o=t[1],c=Object(l.f)();return a.a.createElement("div",{className:"Home"},a.a.createElement(b.a,{id:"name",label:"Group name",variant:"outlined",value:r.value,onChange:function(e){o({value:e.target.value,error:!1})},error:r.error,helperText:r.error&&"Group not found."}),a.a.createElement(m.a,{color:"primary",variant:"contained",onClick:function(e){e.preventDefault();var t=j(r.value);g.groups.by(t).get().then((function(){c.push(t)})).catch((function(){o(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){Object(d.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r,{error:!0}))}))}},"Join"),a.a.createElement("div",{className:"Separator"},a.a.createElement("span",null,"or")),a.a.createElement(m.a,{color:"primary",variant:"contained"},a.a.createElement(p.b,{to:"/create-group"},"Create group")))},D=r(33),w=r(34),k=r(36),P=r(35),C=r(37),S=r(12),N=r.n(S),T=r(82),M=r.n(T);function Y(e){var t=N()(e).startOf("month").day(0),r=N()(e).endOf("month").day(6).diff(t,"days")+1;return new Array(r).fill(0).map((function(r,n){var a=N()(t).add(n,"d");return{disabled:e.month()!==a.month(),day:a}}))}function L(e){return e&&"linear-gradient(180deg, ".concat(e.week," 25%, ").concat(e.day," 25%")}r(119);var x=N.a.weekdaysShort(),A=function(e){function t(){var e,r;Object(D.a)(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(r=Object(k.a)(this,(e=Object(P.a)(t)).call.apply(e,[this].concat(a)))).state={month:N()(),days:Y(N()())},r.nextMonth=function(){r.goToMonth(1)},r.previousMonth=function(){r.goToMonth(-1)},r}return Object(C.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.state.month;return a.a.createElement("div",{className:"Calendar"},a.a.createElement("button",{onClick:this.previousMonth},"<"),a.a.createElement("div",{className:"Calendar-container"},a.a.createElement("div",{className:"Calendar-current-date"},e.format("MMMM YYYY")),a.a.createElement("div",{className:"Calendar-weeks"},x.map((function(e,t){return a.a.createElement("div",{key:t},e)}))),a.a.createElement("div",{className:"Calendar-days"},this.renderDays(e))),a.a.createElement("button",{onClick:this.nextMonth},">"))}},{key:"goToMonth",value:function(e){var t=N()(this.state.month).add(e,"M"),r=Y(t);this.setState({month:t,days:r})}},{key:"getColors",value:function(e){var t=this.props,r=t.drivers,n=t.trips,a=t.cycles.find((function(t){return e>t.start&&null===t.end||e>t.start&&e<t.end}));if(a&&e>=a.start){var o=e.diff(a.start,"days"),c=n[e.format("YYYY-MM-DD")],i=Math.floor(o/7)%r.length,l={driver:r[i],day:r[i].colors[2],week:r[i].colors[2]};return c&&(l.day=r.find((function(e){return e.id===c.driver})).colors[2]),l}}},{key:"renderDays",value:function(e){var t=this;return this.state.days.map((function(e){var r=function(e){return e>0&&e<6}(e.day.days())&&t.getColors(e.day);return a.a.createElement(R,Object.assign({key:e.day.format("DDD")},e,{colors:r,onClick:t.props.onClick}))}))}}]),t}(n.Component),R=function(e){var t=e.day,r=e.disabled,n=e.colors,o=e.onClick,c={className:M()("Day",{"is-disabled":r}),onClick:n?o.bind(null,t,n.driver):function(){return null},style:{background:L(n)}};return a.a.createElement("div",c,a.a.createElement("span",null,t.date()))},G=A,B=(r(120),function(e){function t(){return Object(D.a)(this,t),Object(k.a)(this,Object(P.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.drivers,r=e.onItemClick;return a.a.createElement("div",{className:"DriversList"},t.map((function(e){return a.a.createElement(I,Object.assign({key:e.name},e,{onClick:r&&r.bind(null,e)}))})))}}]),t}(n.Component)),I=function(e){var t=e.colors,r=e.name,n=e.onClick;return a.a.createElement("div",{className:"Driver-photo",onClick:n,style:{background:t[1],borderColor:t[0]}},a.a.createElement("span",null,r[0]))},J=r(46),q=(r(134),r(135),function(e){function t(){return Object(D.a)(this,t),Object(k.a)(this,Object(P.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props,t=e.data,r=e.colorDomain,n=e.colorRange;return a.a.createElement("div",{className:"BalanceGraph"},a.a.createElement(J.d,{width:300,height:150,colorDomain:r,colorRange:n},a.a.createElement(J.b,null),a.a.createElement(J.a,{data:t}),a.a.createElement(J.c,{title:"Balance"})))}}]),t}(n.Component));function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){var t=e.group,r=e.order,o=Object(n.useState)({name:"",order:r}),c=Object(f.a)(o,2),i=c[0],l=c[1];var u;return a.a.createElement("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault(),g.groups.by(t).drivers.post(i).then((function(){window.location.reload()}))}},a.a.createElement(b.a,{id:"outlined-basic",label:"Name",variant:"outlined",value:i.name,onChange:(u="name",function(e){e.preventDefault();var t=e.target.value;l((function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){Object(d.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e,Object(d.a)({},u,t))}))})}),a.a.createElement(m.a,{type:"submit",color:"primary",variant:"contained"},"Add Driver"))}function U(e){var t=e.group,r=e.drivers,n=e.day,o=e.onCancel,c=e.driverTurn;return a.a.createElement("div",null,a.a.createElement("div",null,"Choose a driver for ",n&&n.format("ll")),a.a.createElement(B,{drivers:r,onItemClick:function(e){var r={day:n.toISOString(),driver:e.id,driverTurn:c.id};g.groups.by(t).trips.post(r).then((function(){window.location.reload()}))}}),a.a.createElement(m.a,{color:"primary",onClick:o},"Cancel"))}var V=r(170),H=r(168),W=r(84),X=r.n(W),_=[["#008394","#00bcd4","#33c9dc"],["#aa2e25","#f44336","#f6685e"],["#357a38","#4caf50","#6fbf73"],["#b28704","#ffc107","#ffcd38"],["#6d1b7b","#9c27b0","#af52bf"],["#b26a00","#ff9800","#ffac33"]];function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){Object(d.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Z=function(e){var t=e.group,r=Object(n.useState)({isLoading:!0}),o=Object(f.a)(r,2),c=o[0],i=o[1],l=Object(n.useState)(!1),u=Object(f.a)(l,2),s=u[0],d=u[1],p=Object(n.useState)({open:!1,day:null}),m=Object(f.a)(p,2),b=m[0],v=m[1];function y(){v({open:!1,day:null,driverTurn:null})}return Object(n.useEffect)((function(){var e=g.groups.by(t.key);Promise.all([e.drivers.get(),e.cycles.get(),e.trips.get()]).then((function(e){var t=Object(f.a)(e,3),r=t[0],n=t[1],a=t[2];n=n.map((function(e){return Q({},e,{start:N()(e.start),end:e.end?N()(e.end):null})})),r=r.map((function(e,t){return Q({},e,{colors:_[t]})}));var o=a.reduce((function(e,t){return e[N()(t.day).format("YYYY-MM-DD")]=t,e}),{}),c=r.map((function(e,t){return t})),l=r.map((function(e){return e.colors[1]})),u=function(e){return Object.keys(e).reduce((function(t,r){var n=e[r];return n.driverTurn===n.driver?t:(t[n.driver]||(t[n.driver]=0),t[n.driver]++,t[n.driverTurn]||(t[n.driverTurn]=0),t[n.driverTurn]--,t)}),{})}(o),s=r.map((function(e,t){return{y:t+1,x:u[e.id]||0,color:t}}));i({isLoading:!1,drivers:r,cycles:n,trips:o,colorDomain:c,colorRange:l,graphData:s})}))}),[t.key]),a.a.createElement("div",null,c.isLoading?a.a.createElement("div",null,"Loading"):a.a.createElement(a.a.Fragment,null,a.a.createElement(G,{drivers:c.drivers,trips:c.trips,cycles:c.cycles,onClick:function(e,t){v({open:!0,day:e,driverTurn:t})}}),a.a.createElement("h3",null,"Drivers"),a.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},a.a.createElement(B,{drivers:c.drivers}),a.a.createElement(H.a,{onClick:function(){d(!0)},color:"primary","aria-label":"add"},a.a.createElement(X.a,null))),a.a.createElement(q,{data:c.graphData,colorRange:c.colorRange,colorDomain:c.colorDomain}),a.a.createElement(V.a,{open:s,onClose:function(){d(!1)},"aria-labelledby":"Add Driver","aria-describedby":"modal-description"},a.a.createElement("div",{style:{background:"white"}},a.a.createElement(F,{group:t.key,order:c.drivers.length}))),a.a.createElement(V.a,{open:b.open,onClose:y,"aria-labelledby":"Add Trip Change","aria-describedby":"modal-description"},a.a.createElement("div",{style:{background:"white"}},a.a.createElement(U,{group:t.key,drivers:c.drivers,day:b.day,onCancel:y,driverTurn:b.driverTurn})))))};function $(){var e=Object(n.useState)(!0),t=Object(f.a)(e,2),r=t[0],o=t[1],c=Object(n.useState)({}),i=Object(f.a)(c,2),u=i[0],s=i[1],d=Object(l.g)().key;return Object(n.useEffect)((function(){o(!0),g.groups.by(d).get().then((function(e){o(!1),s(e)})).catch((function(){o(!1),s({error:!0})}))}),[d]),a.a.createElement("div",null,r&&a.a.createElement("div",null,"Loading"),u.error&&a.a.createElement("div",null,"Group not Found"),u.key&&a.a.createElement(Z,{group:u}))}r(138);function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){Object(d.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var re=function(e){return e.replace(/ /g,"-").toLowerCase().trim()};function ne(){var e=Object(n.useState)({name:"",startDate:N()().format("YYYY-MM-DD")}),t=Object(f.a)(e,2),r=t[0],o=t[1],c=Object(n.useState)({name:""}),i=Object(f.a)(c,2),u=i[0],s=i[1],p=Object(l.f)();var v=function(e){return function(t){t.preventDefault();var r=t.target.value;o((function(t){return te({},t,Object(d.a)({},e,r))}))}};return a.a.createElement("form",{className:"CreateGroupForm",noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault();var t=re(r.name);if(!t)return s({name:"Required"});g.groups.by(t).get().then((function(){return s({name:"Name already taken"})})).catch((function(){return g.groups.post(te({},r,{key:t})).then((function(e){p.push(e.key)}))}))}},a.a.createElement(b.a,{id:"outlined-basic",label:"Name",variant:"outlined",value:r.name,onChange:v("name"),error:u.name,helperText:u.name}),a.a.createElement(b.a,{id:"date",label:"Start Date",type:"date",value:r.startDate,variant:"outlined",onChange:v("startDate")}),a.a.createElement(m.a,{type:"submit",color:"primary",variant:"contained"},"Create"))}function ae(){return a.a.createElement("div",null,a.a.createElement("h1",null,"Create Group"),a.a.createElement(ne,null))}var oe=function(){return a.a.createElement(l.c,null,a.a.createElement(l.a,{path:"/about"},"About"),a.a.createElement(l.a,{path:"/create-group"},a.a.createElement(ae,null)),a.a.createElement(l.a,{path:"/:key"},a.a.createElement($,null)),a.a.createElement(l.a,{path:"/"},a.a.createElement(E,null)))};var ce=function(){return a.a.createElement(p.a,{basename:"/carpooling"},a.a.createElement(s,null,a.a.createElement(oe,null)))},ie=r(43);function le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?le(Object(r),!0).forEach((function(t){Object(d.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var se=[{name:"Daniel",order:4},{name:"Luis",order:3},{name:"Cris",order:2},{name:"Vasco",order:1},{name:"Filipa",order:5}].sort((function(e,t){return e.order-t.order})).map((function(e,t){return ue({},e,{id:t,colors:_[t]})})),de={trips:{},startOrder:N()("2018-10-08"),drivers:se},fe=Object(ie.b)({app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_TRIP":return ue({},e,{trips:ue({},e.trips,Object(d.a)({},t.day,{driverOfDay:t.driverOfDay,driverOfWeek:t.driverOfWeek,day:t.day}))});default:return e}}}),pe=Object(ie.c)(fe);r(139);Object(o.render)(a.a.createElement(c.a,{store:pe},a.a.createElement(ce,null)),document.getElementById("root"))},95:function(e,t,r){e.exports=r(140)}},[[95,1,2]]]);
//# sourceMappingURL=main.0b476219.chunk.js.map